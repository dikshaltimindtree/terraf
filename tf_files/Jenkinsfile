
pipeline {
    agent any
    

    stages {
        stage ('Terraform Init tf_files'){
            steps {
                sh "terraform init"
            }
        }
        stage ('Terraform Plan'){
            steps {
                sh "terraform plan tf_files" 
            }
        }
        stage ('Terraform Apply'){
            steps {
                sh "terraform apply tf_files --auto-approve"
            }
        }

        stage('TF Destroy Confirm?') {
            steps {
                script {
                    timeout(time: 4, unit: 'MINUTES') {
                        input(id: "TF Apply", message: "DO you want to destroy created Resources?", ok: 'Destroy')
                    }
                }
            }
        }
        stage ('Terraform Destroy'){
            steps {
                sh "terraform apply -auto-approve"
            }
        }
    }
}
